CREATE VIEW STATISTIKA_ZAPOSLENI AS
SELECT ZAPOSLENI.IME, ZAPOSLENI.PREZIME,
    COUNT(DISTINCT RADNO_MESTO.POZICIJA) AS "Broj razli훾itih pozicija",
    AVG(DATEDIFF(DAY, RADNO_MESTO.DATUMOD, RADNO_MESTO.DATUMDO)) AS "Prose훾no vreme provedeno na radnim mestima"
FROM ZAPOSLENI
JOIN RADNO_MESTO ON ZAPOSLENI.JMBG = RADNO_MESTO.ZJMBG
WHERE RADNO_MESTO.DATUMDO IS NOT NULL
GROUP BY ZAPOSLENI.JMBG, ZAPOSLENI.IME, ZAPOSLENI.PREZIME;

SELECT *
FROM STATISTIKA_ZAPOSLENI
WHERE "Broj razli훾itih pozicija" >= 2
AND "Prose훾no vreme provedeno na radnim mestima" > 300;
